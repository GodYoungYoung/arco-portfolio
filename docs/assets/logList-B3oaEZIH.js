import{a as _}from"./crontab-D56oAgVs.js";import{k as c,S as p,M as C,r as s,o as I,h as L,w as a,f as d,d as r,t as S,ft as B}from"./index-oR0mlNqp.js";const N={__name:"logList",setup(F,{expose:f}){const i=c(),m=c(),l=c(!1),u=c({orderBy:"create_time",orderType:"desc",crontab_id:""}),h=e=>{m.value=e,u.value.crontab_id=e,l.value=!0,i.value.refresh()},v=e=>{const t=e.exception_info;B.info({simple:!1,title:"异常信息",content:t==""?"无异常信息":t})},w=p({autoRequest:!1,api:_.getLogPageList,showSearch:!1,showTools:!1,rowSelection:{showCheckedAll:!0},operationColumnWidth:100,delete:{show:!0,auth:["/core/crontab/deleteLog"],func:async e=>{var n;(await _.deleteLog(e)).code===200&&(C.success("删除成功！"),(n=i.value)==null||n.refresh())}}}),x=p([{title:"执行时间",dataIndex:"create_time",width:180},{title:"执行目标",dataIndex:"target",width:240},{title:"执行结果",dataIndex:"status",width:100},{title:"异常信息",dataIndex:"exception_info",width:100}]);return f({open:h}),(e,t)=>{const n=s("a-tag"),g=s("icon-eye"),b=s("a-link"),k=s("sa-table"),y=s("a-drawer");return I(),L(y,{footer:!1,visible:l.value,"onUpdate:visible":t[0]||(t[0]=o=>l.value=o),width:"850px"},{title:a(()=>[d("执行日志")]),default:a(()=>[r(k,{ref_key:"crudRef",ref:i,options:w,columns:x,searchForm:u.value},{status:a(({record:o})=>[r(n,{color:`${o.status==1?"green":"red"}`},{default:a(()=>[d(S(o.status==1?"成功":"失败"),1)]),_:2},1032,["color"])]),exception_info:a(({record:o})=>[r(b,{onClick:M=>v(o)},{default:a(()=>[r(g),d(" 查看")]),_:2},1032,["onClick"])]),_:1},8,["options","columns","searchForm"])]),_:1},8,["visible"])}}};export{N as default};
