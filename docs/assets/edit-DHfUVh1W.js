import{a as _}from"./notice-Bo3FsI-3.js";import{k as m,fs as E,S as F,r as n,o as M,h as R,w as d,d as s,e as K,K as N,M as O}from"./index-oR0mlNqp.js";const j={__name:"edit",emits:["success"],setup(P,{expose:v,emit:k}){const y=k,c=m(),f=m(""),u=m(!1),p=m(!1);let V=E(()=>"公告管理"+(f.value=="add"?"-新增":"-编辑"));const t=F({id:"",title:"",type:"1",content:"",remark:"",user:""}),b={title:[{required:!0,message:"公告标题不能为空"}],type:[{required:!0,message:"公告类型不能为空"}],content:[{required:!0,message:"公告内容不能为空"}]},g=async(a="add")=>{f.value=a,u.value=!0,c.value.resetFields(),await w()},w=async()=>{},x=async a=>{for(const e in t)a[e]!=null&&a[e]!=null&&(t[e]=a[e])},U=async a=>{var r;if(!await((r=c.value)==null?void 0:r.validate())){p.value=!0;let l={...t},i={};f.value==="add"?(l.id=void 0,i=await _.save(l)):i=await _.update(l.id,l),i.code===200&&(O.success("操作成功"),y("success"),a(!0)),setTimeout(()=>{p.value=!1},500)}a(!1)},C=()=>u.value=!1;return v({open:g,setFormData:x}),(a,e)=>{const r=n("a-input"),l=n("a-form-item"),i=n("sa-select"),q=n("ma-wangEditor"),B=n("a-textarea"),D=n("a-form");return M(),R(N("a-modal"),{visible:u.value,"onUpdate:visible":e[4]||(e[4]=o=>u.value=o),width:800,title:K(V),"mask-closable":!1,"ok-loading":p.value,onCancel:C,onBeforeOk:U},{default:d(()=>[s(D,{ref_key:"formRef",ref:c,model:t,rules:b,"auto-label-width":!0},{default:d(()=>[s(l,{label:"公告标题",field:"title"},{default:d(()=>[s(r,{modelValue:t.title,"onUpdate:modelValue":e[0]||(e[0]=o=>t.title=o),placeholder:"请输入岗位名称"},null,8,["modelValue"])]),_:1}),s(l,{label:"公告类型",field:"type"},{default:d(()=>[s(i,{modelValue:t.type,"onUpdate:modelValue":e[1]||(e[1]=o=>t.type=o),dict:"backend_notice_type",placeholder:"请选择公告类型"},null,8,["modelValue"])]),_:1}),s(l,{label:"公告内容",field:"content"},{default:d(()=>[s(q,{modelValue:t.content,"onUpdate:modelValue":e[2]||(e[2]=o=>t.content=o),placeholder:"请输入公告内容"},null,8,["modelValue"])]),_:1}),s(l,{label:"备注",field:"remark"},{default:d(()=>[s(B,{modelValue:t.remark,"onUpdate:modelValue":e[3]||(e[3]=o=>t.remark=o),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},40,["visible","title","ok-loading"])}}};export{j as default};
