import{m as b}from"./menu-DzJnGZEV.js";import{k as p,fs as K,S as O,r as s,o as i,h as m,w as d,d as t,i as r,e as P,K as S,M as T}from"./index-oR0mlNqp.js";const E={__name:"edit",emits:["success"],setup(j,{expose:U,emit:w}){const g=w,f=p(!1),V=p(!1),y=p(""),v=p(),k=p([]);let B=K(()=>"菜单管理"+(y.value=="add"?"-新增":"-编辑"));const e=O({id:"",parent_id:"",name:"",type:"M",icon:"",code:"",route:"",component:"",sort:100,is_hidden:2,is_layout:1,status:1,remark:""}),x={name:[{required:!0,message:"菜单名称不能为空"}],code:[{required:!0,message:"菜单标识不能为空"}]},C=async(n="add")=>{y.value=n,f.value=!0,v.value.resetFields(),await D()},D=async()=>{const n=await b.getList();k.value=n.data},M=async n=>{for(const l in e)n[l]!=null&&n[l]!=null&&(e[l]=n[l])},L=async n=>{var c;if(!await((c=v.value)==null?void 0:c.validate())){V.value=!0;let o={...e},u={};y.value==="add"?(o.id=void 0,u=await b.save(o)):u=await b.update(o.id,o),u.code===200&&(T.success("操作成功"),g("success"),n(!0)),setTimeout(()=>{V.value=!1},500)}n(!1)},q=()=>f.value=!1;return U({open:C,setFormData:M}),(n,l)=>{const c=s("a-tree-select"),o=s("a-form-item"),u=s("a-input"),_=s("sa-radio"),F=s("ma-icon"),N=s("a-input-number"),R=s("a-textarea"),I=s("a-form");return i(),m(S("a-drawer"),{visible:f.value,"onUpdate:visible":l[12]||(l[12]=a=>f.value=a),width:600,title:P(B),"mask-closable":!1,"ok-loading":V.value,onCancel:q,onBeforeOk:L},{default:d(()=>[t(I,{ref_key:"formRef",ref:v,model:e,rules:x,"auto-label-width":!0},{default:d(()=>[t(o,{label:"上级菜单",field:"parent_id"},{default:d(()=>[t(c,{modelValue:e.parent_id,"onUpdate:modelValue":l[0]||(l[0]=a=>e.parent_id=a),data:k.value,"field-names":{key:"id",title:"name",children:"children",icon:"customIcon"},"allow-clear":"",placeholder:"请选择上级菜单"},null,8,["modelValue","data"])]),_:1}),t(o,{label:"菜单名称",field:"name"},{default:d(()=>[t(u,{modelValue:e.name,"onUpdate:modelValue":l[1]||(l[1]=a=>e.name=a),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1}),t(o,{label:"菜单类型",field:"type"},{default:d(()=>[t(_,{modelValue:e.type,"onUpdate:modelValue":l[2]||(l[2]=a=>e.type=a),dict:"menu_type",placeholder:"请选择菜单类型"},null,8,["modelValue"])]),_:1}),e.type!="B"?(i(),m(o,{key:0,label:"图标",field:"icon"},{default:d(()=>[t(F,{modelValue:e.icon,"onUpdate:modelValue":l[3]||(l[3]=a=>e.icon=a),placeholder:"请选择图标"},null,8,["modelValue"])]),_:1})):r("",!0),t(o,{label:"菜单标识",field:"code"},{default:d(()=>[t(u,{modelValue:e.code,"onUpdate:modelValue":l[4]||(l[4]=a=>e.code=a),placeholder:"请输入菜单标识"},null,8,["modelValue"])]),_:1}),e.type!="B"?(i(),m(o,{key:1,label:"路由地址",field:"route"},{default:d(()=>[t(u,{modelValue:e.route,"onUpdate:modelValue":l[5]||(l[5]=a=>e.route=a),placeholder:"请输入路由地址"},null,8,["modelValue"])]),_:1})):r("",!0),e.type=="M"?(i(),m(o,{key:2,label:"组件地址",field:"component"},{default:d(()=>[t(u,{modelValue:e.component,"onUpdate:modelValue":l[6]||(l[6]=a=>e.component=a),placeholder:"请输入组件地址"},null,8,["modelValue"])]),_:1})):r("",!0),e.type!="B"?(i(),m(o,{key:3,label:"排序数字",field:"sort"},{default:d(()=>[t(N,{modelValue:e.sort,"onUpdate:modelValue":l[7]||(l[7]=a=>e.sort=a),placeholder:"请输入排序数字"},null,8,["modelValue"])]),_:1})):r("",!0),e.type!="B"?(i(),m(o,{key:4,label:"是否隐藏",field:"is_hidden"},{default:d(()=>[t(_,{modelValue:e.is_hidden,"onUpdate:modelValue":l[8]||(l[8]=a=>e.is_hidden=a),dict:"yes_or_no",placeholder:"请选择是否隐藏"},null,8,["modelValue"])]),_:1})):r("",!0),e.type!="B"?(i(),m(o,{key:5,label:"继承Layout",field:"is_layout"},{default:d(()=>[t(_,{modelValue:e.is_layout,"onUpdate:modelValue":l[9]||(l[9]=a=>e.is_layout=a),dict:"yes_or_no",placeholder:"请选择是否继承Layout"},null,8,["modelValue"])]),_:1})):r("",!0),t(o,{label:"状态",field:"status"},{default:d(()=>[t(_,{modelValue:e.status,"onUpdate:modelValue":l[10]||(l[10]=a=>e.status=a),dict:"data_status",placeholder:"请选择状态"},null,8,["modelValue"])]),_:1}),t(o,{label:"备注",field:"remark"},{default:d(()=>[t(R,{modelValue:e.remark,"onUpdate:modelValue":l[11]||(l[11]=a=>e.remark=a),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},40,["visible","title","ok-loading"])}}};export{E as default};
