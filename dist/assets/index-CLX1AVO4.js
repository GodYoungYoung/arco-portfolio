import{a as r}from"./dataMaintain-BO0hPD53.js";import{k as s,S as p,A as P,r as n,fu as U,o as f,c as j,d as o,w as t,L as k,h as y,f as d,M as C}from"./index-oR0mlNqp.js";const T={class:"ma-content-block lg:flex justify-between"},J={__name:"index",setup(W){const m=s(),h=s(),i=s([]),u=s(!1),I=a=>i.value=a,v=async a=>{var c;if(i.value.length===0){C.error("至少要选择一条数据");return}let e;a==="optimize"&&(e=await r.optimize({tables:i.value})),a==="clear"&&(e=await r.fragment({tables:i.value})),e.code==200&&(C.success(e.message),(c=m.value)==null||c.refresh())},S=a=>{var e;x.value.table=a,u.value=!0,(e=h.value)==null||e.refresh()},_=s({name:""}),x=s({table:""}),B=p({api:r.getPageList,rowSelection:{showCheckedAll:!0,key:"name"},operationColumnWidth:100}),F=p([{title:"表名称",dataIndex:"name",width:200,align:"left"},{title:"表引擎",dataIndex:"engine",width:120},{title:"总行数",dataIndex:"rows",width:120},{title:"碎片大小",dataIndex:"data_free",width:150},{title:"数据大小",dataIndex:"data_length",width:150},{title:"索引大小",dataIndex:"index_length",width:150},{title:"字符集",dataIndex:"collation",width:180},{title:"创建时间",dataIndex:"create_time",width:180},{title:"表注释",dataIndex:"comment",width:180}]),M=p({api:r.getDetailed,pageSimple:!0,showSearch:!1,operationColumn:!1}),V=async()=>{},z=async()=>{var a;(a=m.value)==null||a.refresh()};return P(async()=>{V(),z()}),(a,e)=>{const c=n("a-input"),R=n("a-form-item"),D=n("a-col"),$=n("icon-tool"),b=n("a-button"),A=n("icon-experiment"),E=n("icon-eye"),L=n("a-link"),w=n("sa-table"),N=n("a-modal"),g=U("auth");return f(),j("div",T,[o(w,{ref_key:"crudRef",ref:m,options:B,columns:F,searchForm:_.value,onSelectionChange:I},{tableSearch:t(()=>[o(D,{span:12},{default:t(()=>[o(R,{field:"name",label:"表名称"},{default:t(()=>[o(c,{modelValue:_.value.name,"onUpdate:modelValue":e[0]||(e[0]=l=>_.value.name=l),placeholder:"请输入表名称"},null,8,["modelValue"])]),_:1})]),_:1})]),tableBeforeButtons:t(()=>[k((f(),y(b,{onClick:e[1]||(e[1]=l=>v("optimize")),type:"primary",status:"success"},{icon:t(()=>[o($)]),default:t(()=>[d("优化表 ")]),_:1})),[[g,["/core/dataMaintain/optimize"]]]),k((f(),y(b,{onClick:e[2]||(e[2]=l=>v("clear")),type:"primary",status:"success"},{icon:t(()=>[o(A)]),default:t(()=>[d("清理碎片 ")]),_:1})),[[g,["/core/dataMaintain/fragment"]]])]),operationBeforeExtend:t(({record:l})=>[o(L,{onClick:q=>S(l.name)},{default:t(()=>[o(E),d(" 查看 ")]),_:2},1032,["onClick"])]),_:1},8,["options","columns","searchForm"]),o(N,{visible:u.value,"onUpdate:visible":e[3]||(e[3]=l=>u.value=l),width:"900px",footer:!1},{title:t(()=>[d("表结构数据")]),default:t(()=>[o(w,{ref_key:"tableRef",ref:h,options:M,searchForm:x.value,columns:[{title:"字段名称",dataIndex:"column_name"},{title:"字段类型",dataIndex:"column_type"},{title:"字段注释",dataIndex:"column_comment"}]},null,8,["options","searchForm"])]),_:1},8,["visible"])])}}};export{J as default};
