import{a as i}from"./role-BUKAsSP8.js";import $ from"./menuPermission-CCN8nNQj.js";import j from"./dataPermission-D0ckDAtE.js";import z from"./edit-DsD7JYcQ.js";import{k as u,fs as T,S as V,M as d,A as W,r as l,fu as q,o as m,c as R,d as t,w as n,i as b,e as G,h,L as C,f as g}from"./index-oR0mlNqp.js";import"./menu-DzJnGZEV.js";const H={class:"ma-content-block lg:flex justify-between"},J={key:0},te={__name:"index",setup(K){const c=u(),p=u(),y=u(),w=u(),r=u({name:"",code:"",status:""});let D=T(()=>c.value?c.value.isRecovery:!1);const P=e=>{y.value.open(e)},S=e=>{w.value.open(e)},F=V({api:i.getPageList,recycleApi:i.getRecyclePageList,rowSelection:{showCheckedAll:!0},isExpand:!0,operationColumnWidth:300,add:{show:!0,auth:["/core/role/save"],func:async()=>{var e;(e=p.value)==null||e.open()}},edit:{show:!0,auth:["/core/role/update"],func:async e=>{var a,o;if(e.id===1)return d.error("超级管理员角色不可编辑"),!1;(a=p.value)==null||a.open("edit"),(o=p.value)==null||o.setFormData(e)}},delete:{show:!0,auth:["/core/role/destroy"],func:async e=>{var o;if(e.ids.includes(1))return d.error("超级管理员角色不可删除"),!1;(await i.delete(e)).code===200&&(d.success("删除成功！"),(o=c.value)==null||o.refresh())},realAuth:["/core/role/realDestroy"],realFunc:async e=>{var o;(await i.realDestroy(e)).code===200&&(d.success("销毁成功！"),(o=c.value)==null||o.refresh())}},recovery:{show:!0,auth:["/core/role/recovery"],func:async e=>{var o;(await i.recovery(e)).code===200&&(d.success("恢复成功！"),(o=c.value)==null||o.refresh())}}}),I=V([{title:"角色名称",dataIndex:"name",width:220},{title:"角色标识",dataIndex:"code",width:180},{title:"数据权限",dataIndex:"data_scope",dict:"data_scope",width:200},{title:"排序",dataIndex:"sort",width:150},{title:"状态",dataIndex:"status",dict:"data_status",width:100}]),L=async()=>{},f=async()=>{var e;(e=c.value)==null||e.refresh()};return W(()=>{L(),f()}),(e,a)=>{const o=l("a-input"),_=l("a-form-item"),v=l("a-col"),M=l("sa-select"),A=l("icon-menu"),k=l("a-link"),B=l("icon-layers"),E=l("a-space"),N=l("sa-table"),x=q("auth");return m(),R("div",H,[t(N,{ref_key:"crudRef",ref:c,options:F,columns:I,searchForm:r.value},{tableSearch:n(()=>[t(v,{span:8},{default:n(()=>[t(_,{field:"name",label:"角色名称"},{default:n(()=>[t(o,{modelValue:r.value.name,"onUpdate:modelValue":a[0]||(a[0]=s=>r.value.name=s),placeholder:"请输入角色名称"},null,8,["modelValue"])]),_:1})]),_:1}),t(v,{span:8},{default:n(()=>[t(_,{field:"code",label:"角色标识"},{default:n(()=>[t(o,{modelValue:r.value.code,"onUpdate:modelValue":a[1]||(a[1]=s=>r.value.code=s),placeholder:"请输入角色标识"},null,8,["modelValue"])]),_:1})]),_:1}),t(v,{span:8},{default:n(()=>[t(_,{field:"status",label:"状态"},{default:n(()=>[t(M,{modelValue:r.value.status,"onUpdate:modelValue":a[2]||(a[2]=s=>r.value.status=s),dict:"data_status",placeholder:"请选择状态","alow-clear":""},null,8,["modelValue"])]),_:1})]),_:1})]),operationCell:n(({record:s})=>[s.disabled?(m(),R("div",J)):b("",!0)]),operationBeforeExtend:n(({record:s})=>[s.id>1&&!s.disabled&&!G(D)?(m(),h(E,{key:0,size:"mini"},{default:n(()=>[C((m(),h(k,{onClick:U=>P(s)},{default:n(()=>[t(A),g(" 菜单权限")]),_:2},1032,["onClick"])),[[x,["/core/role/menuPermission"]]]),C((m(),h(k,{onClick:U=>S(s)},{default:n(()=>[t(B),g(" 数据权限")]),_:2},1032,["onClick"])),[[x,["/core/role/dataPermission"]]])]),_:2},1024)):b("",!0)]),_:1},8,["options","columns","searchForm"]),t(z,{ref_key:"editRef",ref:p,onSuccess:f},null,512),t($,{ref_key:"mpRef",ref:y,onSuccess:f},null,512),t(j,{ref_key:"dpRef",ref:w,onSuccess:f},null,512)])}}};export{te as default};
