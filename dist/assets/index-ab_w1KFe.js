import{_ as N,m as T,S as $,k as B,A as F,p as V,x as S,M as U,r as l,o as s,c as v,l as c,d as t,w as a,f as y,t as _,e as p,h as r,F as j,g as O}from"./index-oR0mlNqp.js";import{a as q}from"./user-4eeYX97f.js";import z from"./modifyPassword-BQlADqg6.js";import D from"./userInfomation-qAWMC2me.js";const E={class:"block"},P={class:"user-header rounded-sm text-center"},A={class:"pt-3 mx-auto avatar-box"},G={class:"ma-content-block w-full lg:w-6/12 mt-3 p-4"},H={class:"ma-content-block w-full lg:w-6/12 mt-3 p-4 ml-0 lg:ml-3"},J={name:"userCenter"},K=Object.assign(J,{setup(Q){var b;const o=T(),i=$({...o.user}),u=B([]),d=B([]),k=$({limit:5});return F(()=>{V.getLoginLogList(Object.assign(k,{orderBy:"login_time",orderType:"desc"})).then(n=>{u.value=n.data.data}),V.getOperationLogList(Object.assign(k,{orderBy:"create_time",orderType:"desc"})).then(n=>{d.value=n.data.data})}),i.avatar=((b=o==null?void 0:o.user)==null?void 0:b.avatar)??void 0,S(()=>i.avatar,async n=>{n&&(await q.updateInfo({avatar:n})).code===200&&(U.success("头像修改成功"),o.user.avatar=n)}),(n,f)=>{const C=l("sa-upload-image"),I=l("a-tag"),m=l("a-tab-pane"),h=l("a-tabs"),x=l("a-timeline-item"),L=l("a-timeline"),w=l("a-empty"),M=l("a-layout-content");return s(),v("div",E,[c("div",P,[c("div",A,[t(C,{modelValue:i.avatar,"onUpdate:modelValue":f[0]||(f[0]=e=>i.avatar=e),rounded:""},null,8,["modelValue"])]),c("div",null,[t(I,{size:"large",class:"mt-3 rounded-full",color:"#165dff"},{default:a(()=>[y(_(p(o).user&&p(o).user.nickname||p(o).user&&p(o).user.username),1)]),_:1})])]),t(M,{class:"block lg:flex lg:justify-between"},{default:a(()=>[c("div",G,[t(h,{type:"rounded"},{default:a(()=>[t(m,{key:"info",title:"个人资料"},{default:a(()=>[t(D)]),_:1}),t(m,{key:"safe",title:"安全设置"},{default:a(()=>[t(z)]),_:1})]),_:1})]),c("div",H,[t(h,{type:"rounded"},{default:a(()=>[t(m,{key:"login-log",title:"登录日志"},{default:a(()=>[u.value&&u.value.length?(s(),r(L,{key:0,class:"pl-5 mt-3"},{default:a(()=>[(s(!0),v(j,null,O(u.value,(e,g)=>(s(),r(x,{label:`地理位置；${e.ip_location}，操作系统：${e.os}`,key:g},{default:a(()=>[y(" 您于 "+_(e.login_time)+" 登录系统，"+_(e.message),1)]),_:2},1032,["label"]))),128))]),_:1})):(s(),r(w,{key:1}))]),_:1}),t(m,{key:"operation-log",title:"操作日志"},{default:a(()=>[d.value&&d.value.length?(s(),r(L,{key:0,class:"pl-5 mt-3"},{default:a(()=>[(s(!0),v(j,null,O(d.value,(e,g)=>(s(),r(x,{label:`地理位置；${e.ip_location}，方式：${e.method}，路由：${e.router}`,key:g},{default:a(()=>[y(" 您于 "+_(e.create_time)+" 执行了 "+_(e.service_name),1)]),_:2},1032,["label"]))),128))]),_:1})):(s(),r(w,{key:1}))]),_:1})]),_:1})])]),_:1})])}}}),Z=N(K,[["__scopeId","data-v-2f6af2c9"]]);export{Z as default};
