import{c as _}from"./config-DGlCJYQb.js";import{k as r,S as N,r as d,o as b,h as V,w as u,d as o,e as R,i as j,K as G,M as I}from"./index-oR0mlNqp.js";const K=[{label:"文本框",value:"input"},{label:"文本域",value:"textarea"},{label:"下拉选择框",value:"select"},{label:"单选框",value:"radio"},{label:"图片上传",value:"uploadImage"},{label:"文件上传",value:"uploadFile"},{label:"富文本编辑器",value:"wangEditor"}],S={__name:"edit",emits:["success"],setup(L,{expose:y,emit:k}){const w=k,m=r(!1),p=r(!1),f=r(""),c=r(),v=r([]),l=N({id:"",group_id:"",name:"",key:"",value:"",input_type:"input",config_select_data:"",sort:100,remark:""}),x={group_id:[{required:!0,message:"所属组不能为空"}],name:[{required:!0,message:"配置标题不能为空"}],key:[{required:!0,message:"配置标识不能为空"}],input_type:[{required:!0,message:"组件类型不能为空"}]},U=async(n="add")=>{f.value=n,m.value=!0,c.value.resetFields(),await C()},C=async()=>{const n=await _.getConfigGroupList();v.value=n.data},q=async n=>{for(const e in l)n[e]!=null&&n[e]!=null&&(l[e]=n[e])},D=async n=>{var i;if(!await((i=c.value)==null?void 0:i.validate())){p.value=!0;let a={...l},s={};f.value==="add"?(a.id=void 0,s=await _.save(a)):(a.config_select_data&&typeof a.config_select_data=="string"&&(a.config_select_data=a.config_select_data.replace(/\r|\n|\s/g,""),a.config_select_data=a.config_select_data.replace(",]","]")),s=await _.update(a.id,a)),s.code===200&&(I.success("操作成功"),w("success"),n(!0)),setTimeout(()=>{p.value=!1},500)}n(!1)},B=()=>m.value=!1;return y({open:U,setFormData:q}),(n,e)=>{const i=d("a-select"),a=d("a-form-item"),s=d("a-input"),g=d("a-textarea"),E=d("a-input-number"),F=d("ma-codeEditor"),M=d("a-form");return b(),V(G("a-modal"),{visible:m.value,"onUpdate:visible":e[8]||(e[8]=t=>m.value=t),width:800,title:"参数配置"+(f.value=="add"?"-新增":"-编辑"),"mask-closable":!1,"ok-loading":p.value,onCancel:B,onBeforeOk:D},{default:u(()=>[o(M,{ref_key:"formRef",ref:c,model:l,rules:x,"auto-label-width":!0},{default:u(()=>[o(a,{label:"配置组",field:"group_id"},{default:u(()=>[o(i,{modelValue:l.group_id,"onUpdate:modelValue":e[0]||(e[0]=t=>l.group_id=t),options:v.value,"field-names":{label:"name",value:"id"},placeholder:"请选择配置组",disabled:""},null,8,["modelValue","options"])]),_:1}),o(a,{label:"配置标题",field:"name"},{default:u(()=>[o(s,{modelValue:l.name,"onUpdate:modelValue":e[1]||(e[1]=t=>l.name=t),placeholder:"请输入配置标题"},null,8,["modelValue"])]),_:1}),o(a,{label:"配置标识",field:"key"},{default:u(()=>[o(s,{modelValue:l.key,"onUpdate:modelValue":e[2]||(e[2]=t=>l.key=t),placeholder:"请输入配置标识"},null,8,["modelValue"])]),_:1}),o(a,{label:"配置值",field:"value"},{default:u(()=>[o(g,{modelValue:l.value,"onUpdate:modelValue":e[3]||(e[3]=t=>l.value=t),placeholder:"请输入配置值"},null,8,["modelValue"])]),_:1}),o(a,{label:"排序",field:"sort"},{default:u(()=>[o(E,{modelValue:l.sort,"onUpdate:modelValue":e[4]||(e[4]=t=>l.sort=t),min:0,max:999,placeholder:"请输入排序"},null,8,["modelValue"])]),_:1}),o(a,{label:"输入组件",field:"input_type"},{default:u(()=>[o(i,{modelValue:l.input_type,"onUpdate:modelValue":e[5]||(e[5]=t=>l.input_type=t),options:R(K),placeholder:"请选择输入组件"},null,8,["modelValue","options"])]),_:1}),o(a,{label:"配置说明",field:"remark"},{default:u(()=>[o(g,{modelValue:l.remark,"onUpdate:modelValue":e[6]||(e[6]=t=>l.remark=t),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1}),["select","radio"].includes(l.input_type)?(b(),V(a,{key:0,label:"配置数据",field:"config_select_data",extra:'用于配置下拉、单选、复选的数据，格式例子：[{"label":"数据一", "value":"shuju1"},...]'},{default:u(()=>[o(F,{modelValue:l.config_select_data,"onUpdate:modelValue":e[7]||(e[7]=t=>l.config_select_data=t),height:200,placeholder:"请输入配置数据"},null,8,["modelValue"])]),_:1})):j("",!0)]),_:1},8,["model"])]),_:1},40,["visible","title","ok-loading"])}}};export{S as default};
